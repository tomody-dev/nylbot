name: on-comment

# =============================================================================
# on-comment - Project-Specific nylbot Commands Caller
# =============================================================================
# This is the project-specific caller workflow that invokes nylbot-related
# actions with project-specific configuration.
#
# Currently supported commands:
# - /nylbot merge - See .github/actions/nylbot-merge/action.yml for details
#
# CUSTOMIZATION:
# - Modify the `with` inputs below to match your project's branching strategy
# - The actions handle all the logic, so you only need to
#   configure the branch naming conventions here
# =============================================================================

on:
  issue_comment:
    types: [created]

# Concurrency per PR number to avoid parallel execution
concurrency:
  group: on-comment-${{ github.event.issue.number }}
  cancel-in-progress: false

jobs:
  nylbot-merge:
    name: nylbot-merge
    # Only run if this is a PR comment (not an issue)
    if: github.event.issue.pull_request
    runs-on: ubuntu-latest
    permissions:
      contents: write
      pull-requests: write
      issues: write
    steps:
      - name: Checkout repository
        uses: actions/checkout@v6

      - name: Run nylbot-merge action
        uses: ./.github/actions/nylbot-merge
        with:
          github-token: ${{ secrets.GITHUB_TOKEN }}
          # Project-specific branch naming configuration
          release_branch_prefix: "release/"
          develop_branch: "develop"
          sync_branch_prefix: "fix/sync/"
          # Optional: customize retry behavior for mergeable status
          # mergeable_retry_count: 5
          # mergeable_retry_interval: 10
